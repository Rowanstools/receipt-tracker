<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Receipt Tracker</title>
	<style>
		body { font-family: Arial, sans-serif; margin: 2em; }
		.container { max-width: 400px; margin: auto; padding: 2em; border: 1px solid #ccc; border-radius: 8px; }
		label, input, button { display: block; width: 100%; margin-bottom: 1em; }
		#receipt { font-size: 2em; text-align: center; margin-bottom: 1em; }
	</style>
</head>
<body>
	<div class="container">
		<h2>Receipt Tracker</h2>
		<div id="receipt">Loading...</div>
		<form id="claimForm">
			<label for="initials">Your Initials:</label>
			<input type="text" id="initials" maxlength="5" required />
			<button type="submit">Claim Receipt</button>
		</form>
		<div id="message"></div>
	</div>
	<script>
		const API_URL = 'https://corsproxy.io/?https://script.google.com/macros/s/AKfycbyculA5vt0be5gjBdL7aOYMHrximrXzrB2Q4cn3NW_acCh_nT9iZgjyOIbqXGz3EhFQ/exec';

		async function fetchReceipt() {
			const res = await fetch(API_URL);
			const data = await res.json();
			document.getElementById('receipt').textContent = data.nextReceipt;
		}

		document.getElementById('claimForm').addEventListener('submit', async function(e) {
			e.preventDefault();
			const initials = document.getElementById('initials').value.trim();
			if (!initials) return;
			const res = await fetch(API_URL, {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify({ initials })
			});
			const data = await res.json();
			if (data.success) {
				document.getElementById('receipt').textContent = data.receipt + 1;
				document.getElementById('message').textContent = `Receipt ${data.receipt} claimed!`;
			} else {
				document.getElementById('message').textContent = 'Error claiming receipt.';
			}
			document.getElementById('initials').value = '';
		});

		fetchReceipt();
	</script>
</body>
</html>
